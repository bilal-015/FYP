<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign Up | AI Interview Platform</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <style>
      :root {
        --primary: #6366f1;
        --primary-light: #818cf8;
        --secondary: #8b5cf6;
        --light: #f8fafc;
        --dark: #0f172a;
        --darker: #0b1220;
        --gray: #94a3b8;
        --border: rgba(255, 255, 255, 0.08);
        --success: #4ade80;
        --error: #f87171;
        --card-bg: rgba(15, 23, 42, 0.8);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Inter", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, var(--darker), #1e293b);
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
        color: #f8fafc;
        padding: 20px;
        position: relative;
        overflow-x: hidden;
      }

      body::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at 10% 20%,
            rgba(99, 102, 241, 0.15) 0%,
            transparent 20%
          ),
          radial-gradient(
            circle at 90% 80%,
            rgba(139, 92, 246, 0.15) 0%,
            transparent 20%
          );
        z-index: -1;
      }

      /* Toast Notification Styles */
      .toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        gap: 15px;
        max-width: 400px;
      }

      .toast {
        background: rgba(30, 41, 59, 0.95);
        border-radius: 12px;
        padding: 16px 20px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        border-left: 4px solid var(--primary);
        display: flex;
        align-items: center;
        gap: 15px;
        transform: translateX(110%);
        transition: transform 0.3s ease-out;
        backdrop-filter: blur(10px);
      }

      .toast.show {
        transform: translateX(0);
      }

      .toast.success {
        border-color: var(--success);
      }

      .toast.error {
        border-color: var(--error);
      }

      .toast-icon {
        font-size: 24px;
        min-width: 24px;
      }

      .toast.success .toast-icon {
        color: var(--success);
      }

      .toast.error .toast-icon {
        color: var(--error);
      }

      .toast-content {
        flex-grow: 1;
      }

      .toast-title {
        font-weight: 600;
        margin-bottom: 4px;
      }

      .toast-message {
        font-size: 14px;
        color: #cbd5e1;
      }

      .toast-close {
        background: transparent;
        border: none;
        color: var(--gray);
        cursor: pointer;
        font-size: 18px;
        padding: 0;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.2s;
      }

      .toast-close:hover {
        background: rgba(255, 255, 255, 0.1);
        color: white;
      }

      .signup-container {
        background: var(--card-bg);
        border-radius: 20px;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5),
          0 0 0 1px rgba(255, 255, 255, 0.05);
        width: 100%;
        max-width: 600px;
        padding: 40px;
        border: 1px solid var(--border);
        backdrop-filter: blur(10px);
        position: relative;
        z-index: 2;
        animation: fadeIn 0.6s ease-out;
        margin: 20px 0;
      }

      .logo {
        text-align: center;
        margin-bottom: 30px;
      }

      .logo-icon {
        position: relative;
        width: 80px;
        height: 80px;
        margin: 0 auto 15px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .robot-icon {
        font-size: 60px;
        color: #818cf8;
        position: relative;
        z-index: 2;
      }

      .logo h1 {
        font-size: 32px;
        font-weight: 700;
        background: linear-gradient(135deg, #e0e7ff, #ede9fe);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 10px;
      }

      .logo p {
        color: #cbd5e1;
        font-size: 16px;
      }

      .form-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .form-header h2 {
        font-size: 24px;
        margin-bottom: 10px;
        color: #f8fafc;
      }

      .form-header p {
        color: var(--gray);
        font-size: 15px;
      }

      .form-step {
        display: none;
      }

      .form-step.active {
        display: block;
      }

      .form-row {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
      }

      .form-row .input-group {
        flex: 1;
      }

      .input-group {
        margin-bottom: 20px;
        text-align: left;
      }

      .input-group label {
        display: block;
        margin-bottom: 10px;
        font-weight: 500;
        color: #e2e8f0;
        font-size: 14px;
      }

      .input-group input,
      .input-group select {
        width: 100%;
        padding: 14px 18px;
        background: rgba(30, 41, 59, 0.6);
        border: 1px solid var(--border);
        border-radius: 12px;
        font-size: 14px;
        color: #f8fafc;
        transition: all 0.3s;
      }

      .input-group input:focus,
      .input-group select:focus {
        border-color: var(--primary);
        outline: none;
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3);
      }

      .input-group input::placeholder {
        color: #94a3b8;
      }

      .profile-picture {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 20px 0;
        padding: 20px;
        border-radius: 16px;
        background: rgba(30, 41, 59, 0.6);
        border: 1px dashed var(--border);
        transition: all 0.3s;
      }

      .profile-picture:hover {
        border-color: var(--primary-light);
        background: rgba(30, 41, 59, 0.8);
      }

      .profile-preview {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: rgba(30, 41, 59, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
        overflow: hidden;
        border: 2px solid var(--border);
        transition: all 0.3s;
      }

      .profile-picture:hover .profile-preview {
        border-color: var(--primary-light);
        transform: scale(1.05);
      }

      .profile-preview img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .profile-preview i {
        font-size: 36px;
        color: var(--gray);
      }

      .file-input {
        position: relative;
        display: inline-block;
      }

      .file-input input[type="file"] {
        position: absolute;
        left: 0;
        top: 0;
        opacity: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
      }

      .file-input-label {
        background: rgba(67, 97, 238, 0.15);
        color: #a5b4fc;
        padding: 10px 20px;
        border-radius: 10px;
        font-size: 14px;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .file-input-label:hover {
        background: rgba(67, 97, 238, 0.25);
      }

      .password-match {
        font-size: 13px;
        margin-top: 8px;
        display: none;
        padding: 8px 12px;
        border-radius: 8px;
      }

      .password-match.error {
        background: rgba(248, 113, 113, 0.15);
        color: var(--error);
        display: block;
      }

      .password-match.success {
        background: rgba(74, 222, 128, 0.15);
        color: var(--success);
        display: block;
      }

      .btn {
        padding: 14px 25px;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        border: none;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        position: relative;
        overflow: hidden;
      }

      .btn:hover {
        background: linear-gradient(135deg, #5659e6, #7a4deee1);
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(99, 102, 241, 0.4);
      }

      .btn:disabled {
        background: rgba(148, 163, 184, 0.4);
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .login-link {
        margin-top: 25px;
        font-size: 15px;
        color: var(--gray);
        text-align: center;
      }

      .login-link a {
        color: #a5b4fc;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s;
      }

      .login-link a:hover {
        color: #6366f1;
        text-decoration: underline;
      }

      .code-container {
        display: flex;
        justify-content: space-between;
        margin-bottom: 25px;
      }

      .code-input {
        width: 55px;
        height: 60px;
        text-align: center;
        font-size: 24px;
        font-weight: 700;
        padding: 0;
        border-radius: 15px;
      }
      .code-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3);
      }

      .resend-container {
        text-align: center;
        margin-top: 20px;
      }

      .resend-text {
        color: #94a3b8;
        margin-bottom: 10px;
      }

      .resend-btn {
        background: rgba(30, 41, 59, 0.6);
        color: var(--primary);
        padding: 12px 20px;
        border: 1px solid var(--border);
      }

      .resend-btn:hover {
        background: rgba(67, 97, 238, 0.15);
        transform: translateY(-2px);
      }

      .resend-btn:disabled {
        background: rgba(148, 163, 184, 0.4);
        cursor: not-allowed;
        transform: none;
      }

      .timer {
        font-weight: 700;
        color: var(--primary);
      }

      .success-message {
        background: rgba(16, 185, 129, 0.15);
        color: var(--success);
        padding: 12px 16px;
        border-radius: 12px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .error-message {
        background: rgba(239, 68, 68, 0.15);
        color: var(--danger);
        padding: 12px 16px;
        border-radius: 12px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      @media (max-width: 768px) {
        .form-row {
          flex-direction: column;
          gap: 0;
        }

        .signup-container {
          padding: 30px 20px;
        }
      }

      @media (max-width: 480px) {
        .signup-container {
          padding: 25px 15px;
        }

        .logo h1 {
          font-size: 28px;
        }

        .logo-icon {
          width: 70px;
          height: 70px;
        }

        .robot-icon {
          font-size: 50px;
        }

        .code-input {
          width: 45px;
          height: 50px;
          font-size: 20px;
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Floating animation for robot icon */
      @keyframes float {
        0% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
        100% {
          transform: translateY(0px);
        }
      }

      .robot-icon {
        animation: float 4s ease-in-out infinite;
      }
    </style>
  </head>
  <body>
    <div class="toast-container" id="toastContainer"></div>

    <div class="signup-container">
      <div class="logo">
        <div class="logo-icon">
          <i class="fas fa-robot robot-icon"></i>
        </div>
        <h1>InterviewAI</h1>
      </div>

      <!-- Step 1: Registration Form -->
      <div class="form-step active" id="step1">
        <div class="form-header">
          <h2>Create Your Account</h2>
          <p>Create your account to get started</p>
        </div>

        <form id="signupForm">
          <div class="form-row">
            <div class="input-group">
              <label for="fullname">Full Name</label>
              <input
                type="text"
                id="fullname"
                placeholder="Enter your full name"
                required
              />
            </div>

            <div class="input-group">
              <label for="email">Email Address</label>
              <input
                type="email"
                id="email"
                placeholder="Enter your email"
                required
              />
            </div>
          </div>

          <div class="form-row">
            <div class="input-group">
              <label for="phone">Phone Number</label>
              <input
                type="tel"
                id="phone"
                placeholder="Enter your phone number"
                required
              />
            </div>

            <div class="input-group">
              <label for="degree">Degree</label>
              <input
                type="text"
                id="degree"
                placeholder="Enter your degree"
                required
              />
            </div>
          </div>

          <div class="form-row">
            <div class="input-group">
              <label for="job_domain">Job Domain</label>
              <input
                type="text"
                id="job_domain"
                placeholder="Enter your job domain"
                required
              />
            </div>

            <div class="input-group">
              <label for="experience">Experience (Years)</label>
              <input
                type="number"
                id="experience"
                placeholder="Enter your experience"
                min="0"
                step="1"
                onkeydown="return false;"
                required
              />
            </div>
          </div>

          <div class="form-row">
            <div class="input-group">
              <label for="password">Password</label>
              <input
                type="password"
                id="password"
                placeholder="Create a password (min 8 characters)"
                minlength="8"
                required
              />
            </div>

            <div class="input-group">
              <label for="confirmPassword">Confirm Password</label>
              <input
                type="password"
                id="confirmPassword"
                placeholder="Re-enter your password"
                required
              />
              <div class="password-match" id="passwordMatchMessage"></div>
            </div>
          </div>

          <div class="profile-picture">
            <div class="profile-preview" id="profilePreview">
              <i class="fas fa-user"></i>
            </div>
            <div class="file-input">
              <input type="file" id="profileImage" accept="image/*" />
              <label for="profileImage" class="file-input-label">
                <i class="fas fa-upload"></i> Upload Profile Picture (Optional)
              </label>
            </div>
          </div>

          <button type="button" id="sendCodeBtn" class="btn">
            <i class="fas fa-paper-plane"></i> Send Verification Code
          </button>
        </form>

        <div class="login-link">
          Already have an account? <a href="{%url 'login'%}">Log in</a>
        </div>
      </div>

      <!-- Step 2: Code Verification -->
      <div class="form-step" id="step2">
        <div class="form-group">
          <label for="code">Enter 6-digit verification code</label>
          <div class="code-container">
            <input
              type="text"
              class="code-input"
              maxlength="1"
              data-index="0"
            />
            <input
              type="text"
              class="code-input"
              maxlength="1"
              data-index="1"
            />
            <input
              type="text"
              class="code-input"
              maxlength="1"
              data-index="2"
            />
            <input
              type="text"
              class="code-input"
              maxlength="1"
              data-index="3"
            />
            <input
              type="text"
              class="code-input"
              maxlength="1"
              data-index="4"
            />
            <input
              type="text"
              class="code-input"
              maxlength="1"
              data-index="5"
            />
          </div>
        </div>

        <button type="button" id="verifyCodeBtn" class="btn" disabled>
          <i class="fas fa-check"></i>
          Verify Code
        </button>

        <div class="resend-container">
          <p class="resend-text">
            Didn't receive the code? <span class="timer" id="timer">1:00</span>
          </p>
          <button type="button" class="resend-btn" id="resendCodeBtn" disabled>
            <i class="fas fa-redo"></i>
            Resend Code
          </button>
        </div>
      </div>

      <!-- Step 3: Success Message -->
      <div class="form-step" id="step3">
        <button type="button" id="loginBtn" class="btn">
          <i class="fas fa-sign-in-alt"></i>
          Go to Login
        </button>
      </div>
    </div>


    <script>
      // Toast Notification System
      function showToast(message, type = "info", duration = 5000) {
        const toastContainer = document.getElementById("toastContainer");
        const toast = document.createElement("div");
        toast.className = `toast ${type}`;
        toast.innerHTML = `
        <div class="toast-icon">
          ${
            type === "success"
              ? '<i class="fas fa-check-circle"></i>'
              : type === "error"
              ? '<i class="fas fa-exclamation-circle"></i>'
              : '<i class="fas fa-info-circle"></i>'
          }
        </div>
        <div class="toast-content">
          <div class="toast-title">${
            type.charAt(0).toUpperCase() + type.slice(1)
          }</div>
          <div class="toast-message">${message}</div>
        </div>
        <button class="toast-close">
          <i class="fas fa-times"></i>
        </button>
      `;

        toastContainer.appendChild(toast);

        // Show toast with animation
        setTimeout(() => {
          toast.classList.add("show");
        }, 10);

        // Close toast on button click
        const closeBtn = toast.querySelector(".toast-close");
        closeBtn.addEventListener("click", () => {
          toast.classList.remove("show");
          setTimeout(() => {
            toast.remove();
          }, 300);
        });

        // Auto-remove toast after duration
        setTimeout(() => {
          if (toast.classList.contains("show")) {
            toast.classList.remove("show");
            setTimeout(() => {
              toast.remove();
            }, 300);
          }
        }, duration);
      }

      document.addEventListener("DOMContentLoaded", function () {
        // DOM Elements
        const step1 = document.getElementById("step1");
        const step2 = document.getElementById("step2");
        const step3 = document.getElementById("step3");

        const emailInput = document.getElementById("email");
        const sendCodeBtn = document.getElementById("sendCodeBtn");
        const codeInputs = document.querySelectorAll(".code-input");
        const verifyCodeBtn = document.getElementById("verifyCodeBtn");
        const timerElement = document.getElementById("timer");
        const resendCodeBtn = document.getElementById("resendCodeBtn");
        const loginBtn = document.getElementById("loginBtn");
        const passwordInput = document.getElementById("password");
        const confirmPasswordInput = document.getElementById("confirmPassword");
        const passwordMatchMessage = document.getElementById(
          "passwordMatchMessage"
        );

        // Variables
        let generatedCode = "";
        let timerInterval;
        let timerSeconds = 60; // 1 minute
        let formData = new FormData();

        // Event Listeners
        sendCodeBtn.addEventListener("click", sendVerificationCode);
        verifyCodeBtn.addEventListener("click", verifyCode);
        resendCodeBtn.addEventListener("click", resendCode);
        loginBtn.addEventListener("click", () => {
          window.location.href = '{%url "login"%}';
        });

        // Code input navigation
        codeInputs.forEach((input, index) => {
          input.addEventListener("input", () => {
            // Auto-tab to next input
            if (input.value && index < codeInputs.length - 1) {
              codeInputs[index + 1].focus();
            }

            // Check if all inputs are filled
            checkCodeCompletion();
          });

          input.addEventListener("keydown", (e) => {
            // Handle backspace to move to previous input
            if (e.key === "Backspace" && !input.value && index > 0) {
              codeInputs[index - 1].focus();
            }
          });
        });

        // Password confirmation validation
        confirmPasswordInput.addEventListener("input", function () {
          const password = passwordInput.value;
          const confirmPassword = this.value;

          if (confirmPassword.length === 0) {
            passwordMatchMessage.style.display = "none";
            return;
          }

          if (password !== confirmPassword) {
            passwordMatchMessage.textContent = "Passwords don't match!";
            passwordMatchMessage.className = "password-match error";
          } else {
            passwordMatchMessage.textContent = "Passwords match!";
            passwordMatchMessage.className = "password-match success";
          }
        });

        // Profile picture preview
        document
          .getElementById("profileImage")
          .addEventListener("change", function (e) {
            const preview = document.getElementById("profilePreview");
            const file = e.target.files[0];

            if (file) {
              const reader = new FileReader();

              reader.onload = function (e) {
                preview.innerHTML = `<img src="${e.target.result}" alt="Profile Preview">`;
              };

              reader.readAsDataURL(file);
            }
          });

        // Function to validate passwords
        function validatePasswords() {
          const password = passwordInput.value;
          const confirmPassword = confirmPasswordInput.value;

          if (password !== confirmPassword) {
            passwordMatchMessage.textContent = "Passwords don't match!";
            passwordMatchMessage.className = "password-match error";
            return false;
          }

          if (password.length < 8) {
            passwordMatchMessage.textContent =
              "Password must be at least 8 characters!";
            passwordMatchMessage.className = "password-match error";
            return false;
          }

          passwordMatchMessage.textContent = "Passwords match!";
          passwordMatchMessage.className = "password-match success";
          return true;
        }

        // Function to validate email
        function isValidEmail(email) {
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          return emailRegex.test(email);
        }

        // Function to validate form
        function validateForm() {
          const email = emailInput.value.trim();

          if (!isValidEmail(email)) {
            showToast("Please enter a valid email address", "error");
            return false;
          }

          if (!validatePasswords()) {
            showToast("Please check your password fields", "error");
            return false;
          }

          return true;
        }

        // Function to prepare form data
        function prepareFormData() {
          formData = new FormData();
          formData.append(
            "fullname",
            document.getElementById("fullname").value
          );
          formData.append("email", document.getElementById("email").value);
          formData.append("phone", document.getElementById("phone").value);
          formData.append("degree", document.getElementById("degree").value);
          formData.append(
            "job_domain",
            document.getElementById("job_domain").value
          );
          formData.append(
            "experience",
            document.getElementById("experience").value
          );
          formData.append(
            "password",
            document.getElementById("password").value
          );

          const profileImage = document.getElementById("profileImage").files[0];
          if (profileImage) {
            formData.append("profileImage", profileImage);
          }
        }

        // Function to generate random code
        function generateRandomCode() {
          return Math.floor(100000 + Math.random() * 900000).toString();
        }

        // helper for csrf
        function getCookie(name) {
          let cookieValue = null;
          if (document.cookie && document.cookie !== "") {
            let cookies = document.cookie.split(";");
            for (let i = 0; i < cookies.length; i++) {
              let cookie = cookies[i].trim();
              if (cookie.substring(0, name.length + 1) === name + "=") {
                cookieValue = decodeURIComponent(
                  cookie.substring(name.length + 1)
                );
                break;
              }
            }
          }
          return cookieValue;
        }

        // make send_code_to_email return a Promise
        async function send_code_to_email(email, generatedCode) {
          try {
            const response = await fetch("/send_email_verification/", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": getCookie("csrftoken"),
              },
              body: JSON.stringify({ email: email, code: generatedCode }),
            });

            const data = await response.json();

            if (data.success) {
              showToast("Verification code sent to " + email, "success");
              return true; // success
            } else {
              showToast("Failed to send email: " + data.error, "error");
              return false; // failed
            }
          } catch (error) {
            console.error("Error:", error);
            showToast("Error sending verification code", "error");
            return false;
          }
        }

        // Function to send verification code
        async function sendVerificationCode() {
          if (!validateForm()) return;

          prepareFormData();
          const email = emailInput.value.trim();

          // Simulate sending code to email
          generatedCode = generateRandomCode();

          // Show next step
          step1.classList.remove("active");
          step2.classList.add("active");

          showToast("Sending verification code to your email...", "info");

          // wait until email is sent
          const success = await send_code_to_email(email, generatedCode);

          setTimeout(() => {
            startTimer();
          }, 1500);
        }

        // Function to verify code
        async function verifyCode() {
          const enteredCode = Array.from(codeInputs)
            .map((input) => input.value)
            .join("");

          if (enteredCode === generatedCode) {
            // Code is correct, proceed to create account
            showToast("Code verified successfully!", "success");

            try {
              const response = await fetch("/register_candidate/", {
                method: "POST",
                body: formData,
              });

              const result = await response.json();

              if (result.success) {
                // Show success message with toast
                showToast("Account created successfully!", "success");
              } else {
                showToast("Error creating account! " + result.message, "error");
              }
            } catch (error) {
              showToast("Network error: Please try again", "error");
              console.error("Error:", error);
            }

            setTimeout(() => {
              step2.classList.remove("active");
              step3.classList.add("active");
            }, 1000);
          } else {
            showToast("Invalid verification code. Please try again.", "error");
          }
        }

        // Function to resend code
        async function resendCode() {
          const email = emailInput.value.trim();

          // Reset and generate new code
          generatedCode = generateRandomCode();

          // Clear input fields
          codeInputs.forEach((input) => (input.value = ""));
          verifyCodeBtn.disabled = true;

          // Simulate resending code
          showToast("Resending verification code...", "info");

          // wait until email is sent
          const success = await send_code_to_email(email, generatedCode);

          setTimeout(() => {
            showToast("New verification code sent to your email", "success");

            // Reset and start timer
            clearInterval(timerInterval);
            timerSeconds = 60;
            startTimer();
          }, 1500);
        }

        // Function to start timer
        function startTimer() {
          // Update button state
          resendCodeBtn.disabled = true;

          // Update timer immediately
          updateTimerDisplay();

          // Start countdown
          timerInterval = setInterval(() => {
            timerSeconds--;

            if (timerSeconds <= 0) {
              clearInterval(timerInterval);
              resendCodeBtn.disabled = false;
              verifyCodeBtn.disabled = true;
              timerElement.textContent = "00:00";
            } else {
              updateTimerDisplay();
            }
          }, 1000);
        }

        // Function to update timer display
        function updateTimerDisplay() {
          const minutes = Math.floor(timerSeconds / 60);
          const seconds = timerSeconds % 60;
          timerElement.textContent = `${minutes
            .toString()
            .padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;
        }

        // Function to check code completion
        function checkCodeCompletion() {
          const allFilled = Array.from(codeInputs).every(
            (input) => input.value
          );
          if (timerSeconds > 0) {
            verifyCodeBtn.disabled = !allFilled;
          }
        }


        
      });
    </script>
  </body>
</html>
